<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="author" content="dswei" />
  <title>Vue父子组件通信（一）</title>
  <link rel="shortcut icon" href="/favicon.ico">
  <link href="/feed/" rel="alternate" title="dswei" type="application/atom+xml" />
  <link rel="stylesheet" href="/media/css/style.css">
  <!-- <link rel="stylesheet" href="/media/css/highlight.css"> -->
  <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>
</head>

<body>
<div id="container">
  <div id="main" role="main">
    <header>
      <h1>Vue父子组件通信（一）</h1>
    </header>
    <nav>
      <span><a title="home page" class="" href="/">Home</a></span>
      <span><a title="categories" class="" href="/categories/">Categories</a></span>
      <span><a title="tags" class="" href="/tags/">Tags</a></span>
      <span><a title="about" class="" href="/about/">About</a></span>
    </nav>
    <article class="content">
      <section class="post">
<p>父子组件通信的场景很多，例如：</p>

<blockquote>
  <p>父 -&gt; 子：页面上(父)有两个自定义按钮(子)，每个按钮的颜色不一样；</p>

  <p>子 -&gt; 父：点击页面(父)上按钮(子)，页面(父)上一个数字发生了递增</p>
</blockquote>

<h2 id="父---子">父 -&gt; 子</h2>

<blockquote>
  <p>我们以上面讲到的自定义按钮为例子来说明父组件如何调用子组件。</p>
</blockquote>

<h3 id="自定义按钮">自定义按钮</h3>

<p>定义一个自定义按钮组件:<code class="highlighter-rouge">wds-button</code>。如果想使用它，可以在html中这么写：</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;wds-button&gt;&lt;wds-button&gt;</span>
</code></pre>
</div>

<p>得到的效果如下：</p>

<p><img src="http://omcg5d6c2.bkt.clouddn.com/image/vue-parent-child-commucation/single-button.png" alt="自定义按钮" /></p>

<p>具体实现逻辑：</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
    <span class="nt">&lt;style </span><span class="na">scoped</span><span class="nt">&gt;</span>
        <span class="nc">.wds-button</span><span class="p">{</span>
            <span class="nl">line-height</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
            <span class="nl">white-space</span><span class="p">:</span> <span class="nb">nowrap</span><span class="p">;</span>
            <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
            <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
            <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#bfcbd9</span><span class="p">;</span>
            <span class="nl">color</span><span class="p">:</span> <span class="m">#1f2d3d</span><span class="p">;</span>
            <span class="nl">outline</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
            <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
            <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span> <span class="m">15px</span><span class="p">;</span>
            <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
            <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;wds-button&gt;&lt;/wds-button&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"template-wds-button"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"wds-button"</span><span class="nt">&gt;</span>默认按钮<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://cdn.bootcss.com/vue/2.1.10/vue.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="kd">var</span> <span class="nx">wdsButton</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="s1">'#template-wds-button'</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
        <span class="na">el</span><span class="p">:</span> <span class="s1">'#app'</span><span class="p">,</span>
        <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'wds-button'</span><span class="p">:</span> <span class="nx">wdsButton</span>
        <span class="p">}</span>
    <span class="p">})</span>

<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>

<h3 id="多个不同颜色的自定义按钮">多个不同颜色的自定义按钮</h3>

<p>如果我们想实现在页面上显示两个不同颜色自定义按钮呢？我们可能希望通过如下的方式来使用这个自定义按钮，来实现效果。</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;wds-button</span> <span class="na">color=</span><span class="s">"red"</span><span class="nt">&gt;&lt;/wds-button&gt;</span>
<span class="nt">&lt;wds-button</span> <span class="na">color=</span><span class="s">"yellow"</span><span class="nt">&gt;&lt;/wds-button&gt;</span>
</code></pre>
</div>

<p>如果说<code class="highlighter-rouge">wds-button</code>是子组件，那么使用该组件的当前页面则为父组件。这里的color是子组件的自定义属性名（因为用法和html的标签属性的用法一致），而”red”、”yellow”是父组件传递给子组件的值。类似于函数的形参和实参。</p>

<p>因此如果按照上面的那种调用组件的方法，总结一下：</p>

<blockquote>
  <p>子组件得拥有一个自定义的属性：color;</p>

  <p>父组件通过子组件(wds-button)中的自定义属性名(color)，可以将不同的值(red/yellow)<strong>传递</strong>给子组件，从而达到复用子组件的效果。</p>
</blockquote>

<p>那具体在代码层面如何实现呢？</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
  <span class="nt">&lt;style </span><span class="na">scoped</span><span class="nt">&gt;</span>
  <span class="nc">.wds-button</span><span class="p">{</span>
    <span class="nl">line-height</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="nl">white-space</span><span class="p">:</span> <span class="nb">nowrap</span><span class="p">;</span>
    <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
    <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
    <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#bfcbd9</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="m">#1f2d3d</span><span class="p">;</span>
    <span class="nl">outline</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span> <span class="m">15px</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
    <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.wds-button--red</span><span class="p">{</span>
    <span class="nl">background</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.wds-button--yellow</span><span class="p">{</span>
    <span class="nl">background</span><span class="p">:</span> <span class="no">yellow</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">'app'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;wds-button&gt;&lt;/wds-button&gt;</span>
    <span class="nt">&lt;wds-button</span> <span class="na">color=</span><span class="s">"red"</span><span class="nt">&gt;&lt;/wds-button&gt;</span>
    <span class="nt">&lt;wds-button</span> <span class="na">color=</span><span class="s">"yellow"</span><span class="nt">&gt;&lt;/wds-button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">'template-wds-button'</span><span class="nt">&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">v-bind:class=</span><span class="s">"[color ? 'wds-button wds-button--' + color: 'wds-button']"</span><span class="nt">&gt;</span>默认按钮<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://cdn.bootcss.com/vue/2.1.10/vue.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">wdsButton</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">color</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
      <span class="na">default</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'#template-wds-button'</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
  <span class="na">el</span><span class="p">:</span> <span class="s1">'#app'</span><span class="p">,</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'wds-button'</span><span class="p">:</span> <span class="nx">wdsButton</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>

<p><img src="http://omcg5d6c2.bkt.clouddn.com/image/vue-parent-child-commucation/multi-buttons.png" alt="不同颜色的自定义按钮" /></p>

<p>这里子组件的JS对象中需要申明一个属性(<code class="highlighter-rouge">props</code>)，告知调用者暴露的自定属性名字是什么（这里props里又一个属性color），同时给出对应的类型和默认值（type &amp; default）。</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">wdsButton</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">color</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
      <span class="na">default</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'#template-wds-button'</span>
<span class="p">}</span>
</code></pre>
</div>

<p>同时在视图模版中，给自定义按钮绑定一个css class，其值由属性color的值来定。</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">'template-wds-button'</span><span class="nt">&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">v-bind:class=</span><span class="s">"[color ? 'wds-button wds-button--' + color: 'wds-button']"</span><span class="nt">&gt;</span>默认按钮<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre>
</div>

<p>按照上面的方式来，就实现了一个能够传入颜色属性的自定义的组件按钮。同时这个<code class="highlighter-rouge">wds-button</code>组件可以拥有了了一份属于它自己的类似于接口的文档:</p>

<p><strong>Props</strong></p>

<table>
  <thead>
    <tr>
      <th>参数</th>
      <th>说明</th>
      <th>类型</th>
      <th>可选值</th>
      <th>默认</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>color</td>
      <td>按钮颜色</td>
      <td>String</td>
      <td>red/color</td>
      <td>—</td>
    </tr>
  </tbody>
</table>


</section>


<section class="meta">
<br/>
<br/>
<span>
	<a  href="http://localhost:4000/js/2017/03/10/jquery-attr-and-data-diff.html" class="pageNav"  >Previous</a>
	&nbsp;&nbsp;&nbsp;
	<a  href="http://localhost:4000/js/2017/03/06/vue-components-study.html" class="pageNav"  >Next</a>
</span>
<hr>
<span class="author">
  <a href="/about/">dswei</a>
</span>
<span class="time">
  /
  <time datetime="2017-03-09">2017-03-09</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#JS" title="JS">JS</a>&nbsp;
  
</span>


<span class="tags">
  tagged with
  
  <a href="/tags/#Vue" title="Vue">Vue</a>&nbsp;
  
</span>

</section>

<div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
<script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script>
var cloudTieConfig = {
  url: document.location.href,
  sourceId: "",
  productKey: "24024f5a9d78440199bc1498c6aed9b6",
  target: "cloud-tie-wrapper"
};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);
</script>


    </article>

  </div>

  <footer>
    <p>
      <small>
        Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a>
        | Copyright 2017 - 2017 by <a href="/about/">dswei</a>
        | <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1262334832'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1262334832%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
      </small>
    </p>
  </footer>
</div>


</body>
</html>
